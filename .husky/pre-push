#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# Run type check
echo "ğŸ“‹ Final TypeScript check..."
npm run type-check
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript check failed! Cannot push with type errors."
  echo "ğŸ’¡ Run 'npm run type-check' to see the errors."
  echo "âš ï¸  Use 'git push --no-verify' to bypass (NOT RECOMMENDED)"
  exit 1
fi

# Run build to ensure it works
echo "ğŸ“‹ Testing production build..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed! Cannot push code that doesn't build."
  echo "ğŸ’¡ Run 'npm run build' to see the errors."
  echo "âš ï¸  Use 'git push --no-verify' to bypass (NOT RECOMMENDED)"
  exit 1
fi

echo "âœ… All pre-push checks passed!"